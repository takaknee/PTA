# テスト作成ガイドライン

## 基本原則
- テストは簡潔かつ理解しやすく記述する
- 1つのテストは1つの機能や条件のみをテストする
- テスト結果は決定的（同じ入力に対して常に同じ結果）であるべき
- テストケースは関連するものをまとめてテストスイートとして整理する

## テストの構造
- Arrange-Act-Assert (AAA) パターンに従う
  - Arrange: テストの前提条件を設定
  - Act: テスト対象の機能を実行
  - Assert: 期待する結果を検証

## G-suits (Google Apps Script) テスト
- 関数単位でのテストを書く
- モックオブジェクトを活用して外部依存性（スプレッドシートなど）を分離する
- 特殊ケース（エラー処理、境界値）のテストを含める
- `GasUnit` や `QUnit` などのテストフレームワークを活用

## Microsoft 365 (PowerShell) テスト
- `Pester` フレームワークを使用
- モジュール/関数の入出力をテスト
- パラメータの検証とエラー処理をテスト
- ネットワーク呼び出しや外部サービス呼び出しはモック化

## 命名規則
- テスト関数名は `Test_[テスト対象]_[シナリオ]` の形式
- テストスイート名は機能や対象モジュールに関連する名前にする
- テストファイル名は対象ファイル名に `-test` または `.test` を付加

## コメント
- 複雑なテストには目的と検証内容を説明するコメントを付ける
- モックデータを使用する場合は、その構造や意図を説明する

## アサーション
- 明確で具体的なアサーションメッセージを含める
- 複数の状態を検証する場合は、個別にアサーションを書く
- 複雑なオブジェクトの比較には適切な深い比較を使用

## テストデータ
- テストデータはハードコーディングせず、テスト関数内で生成する
- 大量のテストデータが必要な場合はファイルに分離
- 機密データをテストに含めない
