# Outlook OpenAI マクロ - クイックスタートガイド

## 概要
このガイドでは、Outlook OpenAI マクロの導入から基本的な使用方法まで、ステップバイステップで説明します。

## 前提条件
- Microsoft Outlook 2016 以降
- Azure OpenAI サービスのアカウント
- VBA マクロの実行権限

## インストール手順

### ステップ1: Azure OpenAI の準備
1. Azure ポータルにログインします
2. OpenAI サービスを作成します
3. GPT-4 モデルをデプロイします
4. API キーとエンドポイントをメモします

### ステップ2: VBA モジュールのインストール
1. Outlook を起動します
2. `Alt + F11` を押してVBA エディタを開きます
3. `ファイル` → `ファイルのインポート` を選択します
4. 以下のファイルを順番にインポートします：
   - `AI_Common.bas`
   - `AI_ApiConnector.bas`
   - `AI_EmailAnalyzer.bas`
   - `AI_EmailComposer.bas`
   - `AI_SearchAnalyzer.bas`
   - `AI_ConfigManager.bas`

### ステップ3: API 設定の構成
1. VBA エディタで `AI_Common.bas` を開きます
2. 以下の定数を編集します：

```vba
' あなたのAzure OpenAI エンドポイントに変更
Public Const OPENAI_API_ENDPOINT As String = "https://your-resource-name.openai.azure.com/openai/deployments/gpt-4/chat/completions?api-version=2024-02-15-preview"

' あなたのAPI キーに変更
Public Const OPENAI_API_KEY As String = "your-actual-api-key-here"
```

3. `Ctrl + S` で保存します
4. VBA エディタを閉じます

### ステップ4: マクロセキュリティの設定
1. Outlook で `ファイル` → `オプション` を選択
2. `トラストセンター` → `トラストセンターの設定` をクリック
3. `マクロの設定` で「警告を表示してすべてのマクロを無効にする」を選択
4. `OK` をクリックして設定を保存

### ステップ5: 動作確認
1. Outlook を再起動します
2. `Alt + F8` を押してマクロダイアログを開きます
3. `AI_ApiConnector.TestAPIConnection` を選択して実行します
4. 接続成功メッセージが表示されれば完了です

## 基本的な使用方法

### メール内容の解析

#### 転送メールの元内容抽出
1. 分析したいメールを選択します
2. `Alt + F8` を押してマクロ実行ダイアログを開きます
3. `AI_EmailAnalyzer.AnalyzeSelectedEmail` を実行します
4. 分析メニューから「1」を選択します

#### メール内容の明確化
1. 要約したいメールを選択します
2. 同様にマクロを実行し、分析メニューから「2」を選択します
3. 明確化された内容が表示されます

### メール作成支援

#### 営業メール断り作成
1. 断りたい営業メールを選択します
2. `AI_EmailComposer.CreateRejectionEmail` マクロを実行します
3. 断り理由を入力（省略可）します
4. 生成された下書きを確認・編集して送信します

#### 承諾メール作成
1. 承諾したいメールを選択します
2. `AI_EmailComposer.CreateAcceptanceEmail` マクロを実行します
3. 承諾詳細を入力（省略可）します
4. 生成された下書きを確認・編集して送信します

### 検索フォルダ分析

#### 既存検索フォルダの分析
1. `AI_SearchAnalyzer.AnalyzeSearchFolders` マクロを実行します
2. 分析メニューから「1」を選択します
3. 使用状況分析結果を確認します

## よく使用する機能のショートカット設定

### カスタムリボンボタンの追加（オプション）
1. `ファイル` → `オプション` → `リボンのユーザー設定` を選択
2. 新しいグループ「AI Helper」を作成
3. 以下のマクロをボタンとして追加：
   - `AI_EmailAnalyzer.AnalyzeSelectedEmail`
   - `AI_EmailComposer.CreateRejectionEmail`
   - `AI_EmailComposer.CreateAcceptanceEmail`

### クイックアクセスツールバーへの追加
1. リボンの上で右クリック
2. 「クイック アクセス ツール バーのユーザー設定」を選択
3. 「コマンドの選択」から「マクロ」を選択
4. よく使用するマクロを追加

## トラブルシューティング

### よくある問題と解決策

#### API接続エラー
**症状**: "API接続テストに失敗しました"
**原因**: APIキーまたはエンドポイントの設定が間違っている
**解決策**:
1. Azure ポータルでAPIキーとエンドポイントを再確認
2. `AI_Common.bas` の設定を修正
3. ネットワーク接続を確認

#### マクロが実行できない
**症状**: マクロダイアログにマクロが表示されない
**原因**: VBAファイルが正しくインポートされていない
**解決策**:
1. VBAエディタでモジュールが表示されているか確認
2. ファイルを再インポート
3. Outlookを再起動

#### "オブジェクトが見つかりません"エラー
**症状**: メール選択時にエラーが発生
**原因**: メールが選択されていないか、対象外のアイテムが選択されている
**解決策**:
1. メールアイテムを確実に選択
2. 複数選択している場合は1つだけ選択
3. Outlookを再起動

#### 文字化けや不正な応答
**症状**: AIの応答が文字化けしている
**原因**: エンコーディングの問題
**解決策**:
1. プレーンテキストメールで再試行
2. メール本文が長すぎる場合は短縮
3. API設定を確認

### ログの確認方法
1. VBAエディタで `Ctrl + G` を押してイミディエイトウィンドウを開きます
2. デバッグ情報が表示されます
3. エラーの詳細を確認できます

## パフォーマンス最適化

### 処理速度の向上
- 大きなメール（50KB以上）は分割処理を使用
- 一度に多数のメールを処理しない
- API制限を考慮して間隔を空ける

### メモリ使用量の削減
- 不要なメールアイテムの参照を解放
- 定期的にOutlookを再起動
- 処理後は変数をクリア

## セキュリティのベストプラクティス

### APIキーの管理
- APIキーをコード内にハードコーディングしない（本番環境）
- 定期的にAPIキーをローテーション
- 使用していないキーは無効化

### メールデータの保護
- 機密メールは処理前に内容を確認
- 処理ログは定期的に削除
- ネットワーク経由でのデータ送信に注意

## サポートとフィードバック

### 問題報告
問題が発生した場合は、以下の情報を含めて報告してください：
- Outlookのバージョン
- エラーメッセージの全文
- 実行していた操作
- VBAのデバッグ情報

### 機能要望
新機能の要望や改善提案がある場合は、具体的な使用ケースと期待する動作を説明してください。

## 高度な使用方法

### カスタムプロンプトの作成
1. `AI_Common.bas` のシステムプロンプトを編集
2. 特定の業務に最適化されたプロンプトを作成
3. A/Bテストで効果を測定

### バッチ処理の実装
複数のメールを一度に処理したい場合：
1. フォルダ内の全メールを取得
2. ループ処理でAI分析を実行
3. 結果を集約してレポート作成

### 外部システムとの連携
- メール分析結果をExcelに出力
- データベースに結果を保存
- 他のビジネスアプリケーションと連携

## 更新とメンテナンス

### 定期的なメンテナンス
- 月1回のAPI接続テスト
- 不要なログファイルの削除
- バックアップの作成

### アップデート手順
1. 現在の設定をエクスポート
2. 新しいVBAファイルをダウンロード
3. 設定を移行
4. 動作テストを実行

## 次のステップ

基本的な使用方法をマスターしたら：
1. カスタムプロンプトの作成
2. ワークフロー自動化の検討
3. チーム全体での導入計画
4. ROI測定と効果分析

---

このクイックスタートガイドで基本的な操作方法を習得し、日々のメール処理を効率化してください。