# Excel AI Helper - クイックスタートガイド

## 概要
Excel AI Helperは、Azure OpenAI APIを活用してExcelでの作業を効率化するアドインです。表の行単位分析やセルのAI関数生成により、データ分析作業を大幅に短縮できます。

## 主要機能
- **表の行分析**: 学習意欲判定、感情分析、カテゴリ分類、要約生成
- **セルAI関数生成**: Excel関数、データ変換、計算式の自動生成
- **プロンプト管理**: カスタムプロンプトの作成・管理
- **設定管理**: Azure OpenAI API の簡単設定

## システム要件
- Microsoft Excel 2016以降
- Windows 10/11
- Azure OpenAI APIサブスクリプション
- インターネット接続

## インストール手順

### 1. ファイルの準備
以下のVBAファイルをExcelにインポートします：
- `AI_Common.bas`
- `AI_ConfigManager.bas`
- `AI_TableProcessor.bas`
- `AI_CellProcessor.bas`
- `AI_PromptManager.bas`
- `AI_RibbonCallbacks.bas`

### 2. VBAファイルのインポート
1. Excelを開き、`Alt + F11` でVBA エディタを起動
2. `ファイル` > `ファイルのインポート` を選択
3. 上記の6つの.basファイルを順次インポート

### 3. リボンカスタマイズ（オプション）
リボンメニューを追加する場合：
1. `ファイル` > `オプション` > `リボンのユーザー設定`
2. 新しいタブ「AI Helper」を作成
3. 以下のマクロをボタンとして追加：
   - `AI_RibbonCallbacks.ShowMainMenu`
   - `AI_TableProcessor.AnalyzeTableRows`
   - `AI_CellProcessor.GenerateAIFunction`

### 4. マクロセキュリティ設定
1. `ファイル` > `オプション` > `トラストセンター`
2. `トラストセンターの設定` をクリック
3. `マクロの設定` で適切なレベルを選択（推奨：警告を表示してすべてのマクロを無効にする）

## 初期設定

### Azure OpenAI API設定
1. VBAエディタで `AI_ConfigManager.ShowConfigurationMenu` を実行
2. 「1. API設定（Azure OpenAI）」を選択
3. 「1. ガイド付き初期設定」を選択
4. 以下の情報を順次入力：
   - **エンドポイントURL**: Azure ポータルから取得
   - **デプロイメント名**: Azure OpenAI Studioで設定したモデル名
   - **APIキー**: Azure ポータルのキーとエンドポイントから取得
   - **APIバージョン**: 2024-02-15-preview（推奨）

### 設定例
```
エンドポイント: https://your-resource.openai.azure.com/
デプロイメント名: gpt-4
APIキー: your-api-key-here
APIバージョン: 2024-02-15-preview
```

## 基本的な使用方法

### 1. 表の行分析

#### 学習意欲判定の例
1. 分析対象の表範囲を選択（ヘッダー行を含む）
2. VBAエディタで `AI_TableProcessor.AnalyzeTableRows` を実行
3. 「1. 学習意欲判定（0-10スコア）」を選択
4. 出力列を指定（空欄で自動設定）
5. 設定を確認して実行

**サンプルデータ:**
| 参加動機 | 学習内容 |
|---------|---------|
| スキルアップしたい | Excel関数を学びたい |
| 業務効率化 | VBAプログラミング |
| 転職準備 | データ分析手法 |

**実行結果:**
| 参加動機 | 学習内容 | 学習意欲スコア |
|---------|---------|-------------|
| スキルアップしたい | Excel関数を学びたい | 8.5 |
| 業務効率化 | VBAプログラミング | 7.0 |
| 転職準備 | データ分析手法 | 9.0 |

#### 感情分析の例
1. テキストデータを含む表範囲を選択
2. `AI_TableProcessor.AnalyzeTableRows` を実行
3. 「2. 感情分析」を選択
4. 各行のテキストが「ポジティブ」「ネガティブ」「中性」で判定される

### 2. セルAI関数生成

#### Excel関数生成の例
1. 要求内容または参考データを含むセルを選択
2. `AI_CellProcessor.GenerateAIFunction` を実行
3. 「1. Excel関数生成」を選択
4. 追加指示を入力（例：「条件付き合計関数」）
5. 出力先セルを指定
6. 生成された関数をプレビューして適用

**例: 条件付き合計の生成**
- 入力: 「売上データから特定地域の合計を求めたい」
- 出力: `=SUMIF(B:B,"東京",C:C)`

#### データ変換の例
1. 変換対象のデータセルを選択
2. `AI_CellProcessor.GenerateAIFunction` を実行
3. 「2. データ変換」を選択
4. 変換指示を入力（例：「yyyy/mm/dd形式に変換」）
5. 変換結果が生成される

### 3. プロンプト管理

#### カスタムプロンプトの作成
1. `AI_PromptManager.ShowPromptManager` を実行
2. 「2. カスタムプロンプト管理」を選択
3. 「1. 新規カスタムプロンプト作成」を選択
4. プロンプト名、カテゴリ、内容、説明を入力
5. 保存して今後の分析で利用

## 高度な使用方法

### バッチ処理のコツ
- 大量データ（100行以上）は時間がかかるため、夜間実行を推奨
- 処理中断を避けるため、Excelの他の操作は控える
- APIレート制限を考慮し、10行ごとに1秒の待機時間を設ける

### エラー対応
- **API接続エラー**: APIキーとエンドポイントの再確認
- **文字数制限エラー**: データを分割して処理
- **処理タイムアウト**: タイムアウト値を増加（設定管理から変更）

### パフォーマンス最適化
- 不要な行や列は事前に除外
- ヘッダー行は分かりやすい名称に設定
- 空行は削除してから処理実行

## よく使用する機能のショートカット設定

### クイックアクセスツールバーへの追加
1. リボンの上で右クリック
2. 「クイック アクセス ツール バーのユーザー設定」を選択
3. 「コマンドの選択」から「マクロ」を選択
4. よく使用するマクロを追加：
   - `AI_RibbonCallbacks.ShowMainMenu`
   - `AI_TableProcessor.AnalyzeTableRows`
   - `AI_CellProcessor.GenerateAIFunction`

### カスタムリボンボタンの追加（推奨）
1. `ファイル` > `オプション` > `リボンのユーザー設定` を選択
2. 新しいグループ「AI Helper」を作成
3. 以下のマクロをボタンとして追加：
   - `AI_RibbonCallbacks.ShowMainMenu` - メインメニュー
   - `AI_TableProcessor.AnalyzeTableRows` - 表の行分析
   - `AI_CellProcessor.GenerateAIFunction` - AI関数生成
   - `AI_ConfigManager.ShowConfigurationMenu` - 設定管理

## 実用例とユースケース

### 1. アンケート分析
**用途**: PTA参加者アンケートの自動分析
- 参加動機と満足度から学習意欲を定量化
- 自由記述コメントの感情分析
- 改善提案の自動カテゴリ分類

### 2. 業務データ処理
**用途**: 売上データや顧客データの効率化
- 地域別・商品別の自動集計関数生成
- 顧客コメントの感情分析
- データ形式の統一変換

### 3. 教育・研修管理
**用途**: 受講者データの分析
- 学習進捗の自動評価
- 理解度テストの結果分析
- 個別フィードバックの生成

## トラブルシューティング

### よくある問題と解決策

#### 1. 「APIキーが設定されていません」エラー
**原因**: Azure OpenAI APIキーが未設定
**解決策**: 
1. `AI_ConfigManager.ShowConfigurationMenu` を実行
2. API設定からガイド付き初期設定を実行
3. 正しいAPIキーを入力

#### 2. 「API通信エラー」
**原因**: ネットワーク接続またはAPI設定の問題
**解決策**:
1. インターネット接続を確認
2. APIエンドポイントの確認
3. Azure OpenAIサブスクリプションの状態確認
4. 設定管理から接続テストを実行

#### 3. 「処理が遅い」
**原因**: 大量データまたはAPI応答の遅延
**解決策**:
1. 処理対象データを分割
2. タイムアウト値を増加
3. 夜間・早朝の処理実行
4. API利用状況の確認

#### 4. 「結果が期待と異なる」
**原因**: プロンプトの設定やデータ形式の問題
**解決策**:
1. プロンプトテンプレートの見直し
2. カスタムプロンプトの作成
3. サンプルデータでのテスト実行
4. 分析対象データの前処理

### サポートとフィードバック
- 設定で困った場合: 「ガイド付き初期設定」を利用
- 機能改善要望: プロンプト管理からカスタムプロンプトを作成
- エラー詳細: ログ情報（イミディエイトウィンドウ）を確認

## セキュリティとプライバシー

### データ保護
- APIキーは暗号化してレジストリに保存
- 処理データはローカルのみで管理
- Azure OpenAI APIとの通信はHTTPS暗号化

### 個人情報の取り扱い
- 個人識別情報を含むデータの処理時は十分注意
- 機密データの処理前に社内規定を確認
- 必要に応じてデータのマスキング処理を実施

## 次のステップ

基本的な使用方法をマスターしたら：
1. **カスタムプロンプトの作成**: 業務特有の分析要件に対応
2. **ワークフロー自動化の検討**: 定期処理の自動化
3. **チーム全体での導入計画**: 組織全体での効率化
4. **ROI測定と効果分析**: 導入効果の定量化

## 更新履歴
- v1.0.0 (2024): 初回リリース
  - 表の行分析機能
  - セルAI関数生成機能
  - プロンプト管理機能
  - Azure OpenAI API連携

---

このクイックスタートガイドでExcel AI Helperの基本操作を習得し、日々のExcel作業を効率化してください。