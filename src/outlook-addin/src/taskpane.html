<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>PTA Outlook アドイン - 詳細パネル</title>

    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    
    <!-- PTA Styles -->
    <link rel="stylesheet" type="text/css" href="../assets/styles.css" />
</head>

<body class="ms-font-m ms-welcome">
    <header class="ms-welcome__header ms-bgColor-neutralLighter">
        <img width="45" height="45" src="../assets/logo-filled.png" alt="PTA" title="PTA" />
        <h2 class="ms-font-xl">PTA AI助手</h2>
    </header>
    
    <main id="app-body" class="ms-welcome__main">
        <div class="ms-welcome__content">
            <div class="tabs-container">
                <div class="tab-headers">
                    <button class="tab-header active" data-tab="analyze">解析</button>
                    <button class="tab-header" data-tab="settings">設定</button>
                    <button class="tab-header" data-tab="history">履歴</button>
                </div>
                
                <!-- 解析タブ -->
                <div id="analyze-tab" class="tab-content active">
                    <div class="section">
                        <h3>メール解析</h3>
                        <div class="form-group">
                            <label for="analysis-type" class="ms-font-m">解析タイプ：</label>
                            <select id="analysis-type" class="form-control">
                                <option value="summary">要約</option>
                                <option value="action-items">アクション項目</option>
                                <option value="sentiment">感情分析</option>
                                <option value="priority">優先度評価</option>
                                <option value="custom">カスタム</option>
                            </select>
                        </div>
                        
                        <div class="form-group" id="custom-prompt-group" style="display: none;">
                            <label for="custom-prompt" class="ms-font-m">カスタムプロンプト：</label>
                            <textarea id="custom-prompt" class="form-control" rows="3"
                                      placeholder="AIに対する指示を入力してください"></textarea>
                        </div>
                        
                        <button class="ms-welcome__action" id="analyze-email-button">
                            <span class="ms-font-m">解析実行</span>
                        </button>
                        
                        <div id="analysis-results" class="results-container"></div>
                    </div>
                </div>
                
                <!-- 設定タブ -->
                <div id="settings-tab" class="tab-content">
                    <div class="section">
                        <h3>API設定</h3>
                        <div class="form-group">
                            <label for="api-provider" class="ms-font-m">AIプロバイダー：</label>
                            <select id="api-provider" class="form-control">
                                <option value="openai">OpenAI</option>
                                <option value="claude">Claude</option>
                                <option value="azure">Azure OpenAI</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="api-key" class="ms-font-m">APIキー：</label>
                            <input type="password" id="api-key" class="form-control" 
                                   placeholder="APIキーを入力してください" />
                        </div>
                        
                        <div class="form-group">
                            <label for="model" class="ms-font-m">モデル：</label>
                            <select id="model" class="form-control">
                                <option value="gpt-4">GPT-4</option>
                                <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                                <option value="claude-3">Claude 3</option>
                            </select>
                        </div>
                        
                        <button class="ms-welcome__action" id="save-settings-button">
                            <span class="ms-font-m">設定保存</span>
                        </button>
                        
                        <button class="ms-welcome__action secondary" id="test-api-button">
                            <span class="ms-font-m">接続テスト</span>
                        </button>
                    </div>
                </div>
                
                <!-- 履歴タブ -->
                <div id="history-tab" class="tab-content">
                    <div class="section">
                        <h3>解析履歴</h3>
                        <div id="history-list" class="history-list">
                            <p class="ms-font-m">履歴はまだありません。</p>
                        </div>
                        
                        <button class="ms-welcome__action secondary" id="clear-history-button">
                            <span class="ms-font-m">履歴クリア</span>
                        </button>
                    </div>
                </div>
            </div>
            
            <div id="loading-container" class="loading-container" style="display: none;">
                <div class="ms-Spinner ms-Spinner--large"></div>
                <p class="ms-font-m">処理中...</p>
            </div>
        </div>
    </main>

    <!-- PTA Scripts -->
    <script type="text/javascript" src="taskpane.js"></script>
</body>
</html>