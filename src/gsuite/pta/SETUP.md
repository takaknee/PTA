# PTA情報配信システム - セットアップガイド

## クイックスタート

### 1. 必要なファイル
以下のファイルをGoogle Apps Scriptプロジェクトにコピーしてください：

```
src/gsuite/pta/
├── appsscript.json           # 設定ファイル
├── ptaCore.gs               # メインシステム  
├── memberManagement.gs      # メンバー管理
├── informationDistribution.gs # 情報配信
├── surveyManagement.gs      # アンケート管理
├── scheduleNotifications.gs # スケジュール通知
└── testFunctions.gs         # テスト用（オプション）
```

### 2. 設定手順

1. **Googleスプレッドシート作成**
   - 新しいスプレッドシートを作成
   - 「拡張機能」→「Apps Script」を選択

2. **ファイルのコピー**
   - 上記7ファイルの内容をそれぞれコピー
   - Apps Scriptエディタで新しいファイルを作成して貼り付け

3. **権限の許可**
   - スプレッドシートに戻ってページ更新（F5）
   - 「PTA情報配信システム」メニューが表示される
   - 「システム」→「初期設定を実行」を選択
   - 必要な権限をすべて許可

4. **初期データの準備**
   - 初期設定で自動的にシートが作成される
   - 必要に応じて「デモデータ作成」を実行してテスト

### 3. 基本的な使い方

#### メンバー追加
1. 「メンバー管理」→「新しいメンバーを追加」
2. 氏名とメールアドレスを入力

#### 情報配信
1. 「情報配信」→「情報をメール配信」
2. 件名と本文を入力して送信

#### アンケート作成
1. 「アンケート管理」→「新しいアンケートを作成」
2. タイトル、説明、締切日を入力
3. 質問を追加

#### イベント通知
1. 「スケジュール」→「イベント通知を送信」
2. イベント詳細を入力
3. カレンダー連携の設定

## 実装された機能一覧

### ✅ メンバー管理
- [x] メンバー登録・更新・削除
- [x] ステータス管理（アクティブ/非アクティブ/退会）
- [x] メンバー統計とエクスポート
- [x] 重複チェックとメール形式検証

### ✅ 情報配信
- [x] 一括メール配信
- [x] メールテンプレート管理
- [x] 配信履歴追跡
- [x] バッチ処理による効率配信

### ✅ アンケート管理
- [x] Googleフォーム自動作成
- [x] アンケート配信
- [x] 回答結果集計・表示
- [x] 結果概要の配信

### ✅ スケジュール通知
- [x] イベント通知送信
- [x] Googleカレンダー連携
- [x] 参加確認（RSVP）機能
- [x] 定期配信設定

### ✅ システム機能
- [x] 総合メニューシステム
- [x] 自動初期設定
- [x] ログ記録・履歴管理
- [x] エラーハンドリング

## トラブルシューティング

### 権限エラー
- Apps Scriptで全ての権限を許可
- Googleアカウントの2段階認証を確認

### メール送信失敗
- Gmail APIクォータを確認
- 送信先アドレスの正確性を確認

### 設定確認
- 「システム」→「システムログを確認」
- テスト機能で基本動作を確認

## サポート

詳細なドキュメント: `README.md`
技術的な問題: GitHubのIssues

---

このシステムにより、PTAでの情報配信が効率化されます！